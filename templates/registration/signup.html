{% extends "admin/base_site.html" %}
{% load i18n static %}

    {% block extrastyle %}
        {{ block.super }}
        <link rel="stylesheet" href="{% static 'orderpiqrApp/css/signup.css' %}">
    {% endblock %}
{% block content %}
    {% get_current_language as LANGUAGE_CODE %}
    {% get_available_languages as LANGUAGES %}
    {% get_language_info_list for LANGUAGES as languages %}
<div style="position: absolute; right: 3%">
    <div class="language-dropdown">
        <button class="dropdown-toggle">
            <img src="{% static 'orderpiqrApp/flags/'|add:LANGUAGE_CODE|add:'.png' %}"
                 alt="{{ current_language.name_local }}"
                 title="{{ current_language.name_local }}"
                 class="current-lang-img">
            {{ current_language.name_local }}
        </button>
        <div class="dropdown-menu">
            {% for lang in languages %}
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.path }}">
                    <input type="hidden" name="language" value="{{ lang.code }}">
                    <button type="submit" class="dropdown-item">
                        <img src="{% static 'orderpiqrApp/flags/'|add:lang.code|add:'.png' %}"
                             alt="{{ lang.name_local }}"
                             title="{{ lang.name_local }}" style="max-width: 60px">
                        {{ lang.name_local }}
                    </button>
                </form>
            {% endfor %}
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropdown = document.querySelector('.language-dropdown');
            const toggle = dropdown.querySelector('.dropdown-toggle');

            toggle.addEventListener('click', function (e) {
                e.stopPropagation();
                dropdown.classList.toggle('show');
            });

            document.addEventListener('click', function () {
                dropdown.classList.remove('show');
            });
        });
    </script>
    </div>
    <div id="content" class="signup-container">
        <div class="signup-card">
            <h1 class="title">{% trans "Create your Orderpiqr workspace" %}</h1>
            <p class="intro">
                {% blocktrans %}
                    Set up your company with two accounts: one administrator and one order picker.
                    Usernames must be unique within your company, but emails donâ€™t have to be unique globally.
                    If you have any questions, email <a href="mailto:info@orderpiqr.nl">info@orderpiqr.nl</a>
                {% endblocktrans %}
            </p>

            {% if form.non_field_errors %}
                <div class="errornote">
                    {% for err in form.non_field_errors %}
                        <div>{{ err }}</div>{% endfor %}
                </div>
            {% endif %}

            <form method="post" novalidate>
                {% csrf_token %}

                <div class="module aligned">
                    {% for field in form.visible_fields %}
                        <div class="form-row{% if field.errors %} errors{% endif %}">
                            {{ field.label_tag }}
                            {{ field }}
                            {% if field.help_text %}<p class="help">{{ field.help_text }}</p>{% endif %}
                            {% for error in field.errors %}
                                <ul class="errorlist">
                                    <li>{{ error }}</li>
                                </ul>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>

                <div class="submit-row">
                    <input type="submit" class="default" value="{% trans 'Create company and users' %}">
                    {#        <a href="{% url 'login' %}" class="deletelink">{% trans "Cancel" %}</a>#}
                </div>
            </form>

            <p class="footer-note">
                {% trans "Already have an account?" %}
                <a href="{% url 'login' %}">{% trans "Log in" %}</a>
            </p>
        </div>
    </div>
{% endblock %}
