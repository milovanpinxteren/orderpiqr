<!DOCTYPE html>
{% load static i18n %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'orderpiqrApp/css/name_entry.css' %}"/>
    <title>{% trans "Enter Your Name" %}</title>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3.0.0/dist/fp.min.js"></script>
    <link rel="icon" type="image/png" href="{% static 'orderpiqrApp/img/favicon.png' %}">

</head>
<body>
<h2>{% trans "Enter Your Name" %}</h2>
<form method="POST" id="name-form">
    {% csrf_token %}
    <label for="name">{% trans "Name:" %}</label>
    <input type="text" id="name" name="name" required>
    <button type="submit">{% trans "Submit" %}</button>
</form>
<script type="text/javascript">
    FingerprintJS.load().then(fingerprintJS => {
        fingerprintJS.get().then(result => {
            const deviceFingerprint = result.visitorId;
            // Add the fingerprint to the form before submission
            const form = document.getElementById('name-form');
            const fingerprintInput = document.createElement('input');
            fingerprintInput.type = 'hidden';
            fingerprintInput.name = 'device_fingerprint';  // The name of the hidden field
            fingerprintInput.value = deviceFingerprint;
            // Append the fingerprint to the form
            form.appendChild(fingerprintInput);
        });
    });
</script>
</body>
</html>
