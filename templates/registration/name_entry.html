<!DOCTYPE html>
{% load static i18n %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'orderpiqrApp/css/name_entry.css' %}"/>
    <title>{% trans "Enter Your Name" %}</title>
    <link rel="icon" type="image/png" href="{% static 'orderpiqrApp/img/favicon.png' %}">

</head>
<body>
<h2>{% trans "Enter Your Name" %}</h2>
<form method="POST" id="name-form">
    <img src="{% static 'orderpiqrApp/img/favicon.png' %}" alt="Orderpiqr Logo" class="login-logo">
    {% csrf_token %}
    <label for="name">{% trans "Name:" %}</label>
    <input type="text" id="name" name="name" required>
    <button type="submit">{% trans "Submit" %}</button>
</form>
<script type="text/javascript">
    (function() {
        const STORAGE_KEY = 'orderpiqr_device_id';
        let deviceId = localStorage.getItem(STORAGE_KEY);
        if (!deviceId) {
            deviceId = (typeof crypto !== 'undefined' && crypto.randomUUID)
                ? crypto.randomUUID()
                : 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c === 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
            localStorage.setItem(STORAGE_KEY, deviceId);
        }
        const form = document.getElementById('name-form');
        const fingerprintInput = document.createElement('input');
        fingerprintInput.type = 'hidden';
        fingerprintInput.name = 'device_fingerprint';
        fingerprintInput.value = deviceId;
        form.appendChild(fingerprintInput);
    })();
</script>
</body>
</html>
