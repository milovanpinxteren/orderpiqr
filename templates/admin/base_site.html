{% extends "admin/base_site.html" %}
{% load static i18n %}

{% block extrahead %}
    {{ block.super }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intro.js/minified/introjs.min.css">
    <script src="https://cdn.jsdelivr.net/npm/intro.js/minified/intro.min.js"></script>
    <script src="{% url 'javascript-catalog' %}"></script>
    <link rel="stylesheet" href="{% static 'orderpiqrApp/admin/css/tour.css' %}">
    {#    <link rel="stylesheet" type="text/css" href="{% static 'orderpiqrApp/admin/css/custom_admin.css' %}">#}

    <script type="module" src="{% static 'orderpiqrApp/admin/js/tour/start.js' %}"></script>
    <script type="module" src="{% static 'orderpiqrApp/admin/js/tour/sections/product.js' %}"></script>
    <script type="module" src="{% static 'orderpiqrApp/admin/js/tour/sections/order.js' %}"></script>
    <script type="module" src="{% static 'orderpiqrApp/admin/js/tour/sections/picklist.js' %}"></script>
    <script type="module" src="{% static 'orderpiqrApp/admin/js/tour/sections/device.js' %}"></script>
    <link rel="icon" type="image/png" href="{% static 'orderpiqrApp/img/favicon.png' %}">
{% endblock %}
{% block extrastyle %}
    <link rel="stylesheet" type="text/css" href="{% static 'orderpiqrApp/css/custom_admin.css' %}">
    <style>
        #changelist {
            min-width: 150vh;
        }
    </style>
{% endblock %}
{% block title %}Orderpiqr admin{% endblock %}

{% block branding %}
    <a id="top" href="#container" class="active animate"></a>
    <h1 id="site-name"><a href="/">Orderpiqr admin</a></h1>
    <button
            type="button"
            class="tour-btn"
            onclick="startAdminTour()"
            aria-label="{% trans 'Start tour' %}"
            title="{% trans 'Start tour' %}" data-label="{% trans 'Start tour' %}">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <polygon points="16.24,7.76 14.12,14.12 7.76,16.24 9.88,9.88" fill="currentColor"/>
        </svg>
        <span class="tour-tooltip">{% trans 'Start tour' %}</span>

    </button>


{% endblock branding %}
{% block userlinks %}
    {{ block.super }}
    {% get_current_language as LANGUAGE_CODE %}
    {% get_available_languages as LANGUAGES %}
    {% get_language_info_list for LANGUAGES as languages %}

    <div class="language-dropdown">
        <button class="dropdown-toggle">
            <img src="{% static 'orderpiqrApp/flags/'|add:LANGUAGE_CODE|add:'.png' %}"
                 alt="{{ current_language.name_local }}"
                 title="{{ current_language.name_local }}"
                 class="current-lang-img">
            {{ current_language.name_local }}
        </button>
        <div class="dropdown-menu">
            {% for lang in languages %}
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.path }}">
                    <input type="hidden" name="language" value="{{ lang.code }}">
                    <button type="submit" class="dropdown-item">
                        <img src="{% static 'orderpiqrApp/flags/'|add:lang.code|add:'.png' %}"
                             alt="{{ lang.name_local }}"
                             title="{{ lang.name_local }}">
                        {{ lang.name_local }}
                    </button>
                </form>
            {% endfor %}
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropdown = document.querySelector('.language-dropdown');
            const toggle = dropdown.querySelector('.dropdown-toggle');

            toggle.addEventListener('click', function (e) {
                e.stopPropagation();
                dropdown.classList.toggle('show');
            });

            document.addEventListener('click', function () {
                dropdown.classList.remove('show');
            });
        });
    </script>

{% endblock userlinks %}
