{% extends "admin/base_site.html" %}
{% load static i18n %}
{% block extrahead %}
    {{ block.super }}
    <link rel="icon" type="image/png" href="{% static 'orderpiqrApp/img/favicon.png' %}">
{% endblock %}
{% block extrastyle %}
    <link rel="stylesheet" type="text/css" href="{% static 'orderpiqrApp/css/custom_admin.css' %}">
{% endblock %}
{% block title %}Orderpiqr admin{% endblock %}

{% block branding %}
    <a id="top" href="#container" class="active animate"></a>
    <h1 id="site-name"><a href="/">Orderpiqr admin</a></h1>

{% endblock branding %}
{% block userlinks %}
    {{ block.super }}
    {% get_current_language as LANGUAGE_CODE %}
    {% get_available_languages as LANGUAGES %}
    {% get_language_info_list for LANGUAGES as languages %}

    <div class="language-dropdown">
        <button class="dropdown-toggle">
            <img src="{% static 'orderpiqrApp/flags/'|add:LANGUAGE_CODE|add:'.png' %}"
                 alt="{{ current_language.name_local }}"
                 title="{{ current_language.name_local }}"
                 class="current-lang-img">
            {{ current_language.name_local }}
        </button>
        <div class="dropdown-menu">
            {% for lang in languages %}
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.path }}">
                    <input type="hidden" name="language" value="{{ lang.code }}">
                    <button type="submit" class="dropdown-item">
                        <img src="{% static 'orderpiqrApp/flags/'|add:lang.code|add:'.png' %}"
                             alt="{{ lang.name_local }}"
                             title="{{ lang.name_local }}">
                        {{ lang.name_local }}
                    </button>
                </form>
            {% endfor %}
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropdown = document.querySelector('.language-dropdown');
            const toggle = dropdown.querySelector('.dropdown-toggle');

            toggle.addEventListener('click', function (e) {
                e.stopPropagation();
                dropdown.classList.toggle('show');
            });

            document.addEventListener('click', function () {
                dropdown.classList.remove('show');
            });
        });
    </script>

{% endblock userlinks %}
